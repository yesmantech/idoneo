import{j as e}from"./framer-BdaCTGm4.js";import{u as z,r as o}from"./router-ClfHAwMg.js";import{s as v}from"./index-BBBGEo7o.js";import{S as F}from"./SEOHead-B7u-rzTH.js";import{S as I,C as S,Z as C,H as E,a as A,b as w}from"./icons-ByDj-hsa.js";import"./react-vendor-B--z-fyW.js";import"./supabase-CIvuJI4W.js";function T(){const y=z(),[r,j]=o.useState(!1),[n,c]=o.useState(""),[l,u]=o.useState(""),[x,s]=o.useState(null),[g,m]=o.useState(!1),[d,f]=o.useState(!1),N=[{Icon:I,color:"text-amber-400",bg:"bg-amber-100",top:"15%",left:"10%",size:"w-12 h-12",delay:"0s"},{Icon:S,color:"text-sky-400",bg:"bg-sky-100",top:"12%",right:"15%",size:"w-16 h-16",delay:"0.5s"},{Icon:C,color:"text-yellow-500",bg:"bg-yellow-100",bottom:"20%",left:"8%",size:"w-14 h-14",delay:"1s"},{Icon:E,color:"text-rose-400",bg:"bg-rose-100",bottom:"15%",right:"10%",size:"w-12 h-12",delay:"1.5s"},{Icon:A,color:"text-indigo-400",bg:"bg-indigo-100",top:"45%",left:"5%",size:"w-10 h-10",delay:"2s"},{Icon:w,color:"text-purple-400",bg:"bg-purple-100",top:"40%",right:"5%",size:"w-14 h-14",delay:"2.5s"}],k=async t=>{var i,h;t.preventDefault(),m(!0),s(null);try{if(r){const{error:a}=await v.auth.signInWithPassword({email:n,password:l});if(a)throw a;y("/profile/setup")}else{const{data:a,error:b}=await v.auth.signUp({email:n,password:l,options:{emailRedirectTo:`${window.location.origin}/profile/setup`}});if(b)throw b;if(((h=(i=a==null?void 0:a.user)==null?void 0:i.identities)==null?void 0:h.length)===0){s("Questo indirizzo email è già registrato. Accedi al tuo account!");return}f(!0)}}catch(a){console.error("Auth Error:",a),a.message&&(a.message.includes("already registered")||a.message.includes("User already exists"))?s("Questo indirizzo email è già registrato. Accedi al tuo account!"):s(a.message||"Errore durante l'autenticazione")}finally{m(!1)}},p=()=>{j(!r),s(null),f(!1),c(""),u("")};return e.jsxs("div",{className:"min-h-screen bg-[var(--background)] text-[var(--foreground)] font-sans flex flex-col justify-center overflow-hidden relative transition-colors duration-500",children:[e.jsx(F,{title:r?"Accedi | Idoneo":"Inizia ora | Idoneo",description:"Entra nel mondo di Idoneo e inizia a prepararti per il tuo futuro nelle Forze Armate e di Polizia."}),e.jsx("div",{className:"absolute inset-0 pointer-events-none",children:N.map((t,i)=>e.jsx("div",{className:`absolute rounded-full flex items-center justify-center ${t.bg} dark:bg-slate-800/50 ${t.size} animate-in fade-in zoom-in duration-1000 opacity-60 dark:opacity-40`,style:{top:t.top,left:t.left,right:t.right,bottom:t.bottom,animationDelay:t.delay},children:e.jsx(t.Icon,{className:`w-1/2 h-1/2 ${t.color}`,strokeWidth:2.5})},i))}),e.jsxs("div",{className:"w-full max-w-md mx-auto px-6 flex flex-col items-center justify-center space-y-8 animate-in slide-in-from-bottom-10 fade-in duration-700 delay-300 relative z-10 pb-8",children:[d?e.jsxs("div",{className:"space-y-4 text-center w-full animate-in zoom-in-50 duration-500",children:[e.jsx("div",{className:"mx-auto w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mb-4",children:e.jsx(w,{className:"w-10 h-10 text-green-600 dark:text-green-400"})}),e.jsx("h1",{className:"text-3xl font-bold tracking-tight text-[var(--foreground)]",children:"Controlla l'email"}),e.jsx("p",{className:"text-lg text-[var(--foreground)] opacity-60 leading-relaxed max-w-sm mx-auto",children:"Ti abbiamo inviato un link magico per accedere. Cliccalo per confermare la tua identità!"}),e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-800 rounded-xl text-sm text-[var(--foreground)] opacity-50 border border-slate-100 dark:border-slate-700",children:"Non trovi l'email? Controlla nello spam o riprova."}),e.jsx("button",{onClick:p,className:"text-[#00B1FF] font-bold text-sm hover:underline mt-4",children:"Torna al login"})]}):e.jsxs("div",{className:"space-y-3 text-center w-full",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight text-[var(--foreground)] leading-[1.1]",children:r?"Bentornato":"Benvenuto"}),e.jsx("h2",{className:"text-[17px] md:text-lg font-medium text-[var(--foreground)] opacity-50 leading-relaxed max-w-xs mx-auto",children:r?"Inserisci le tue credenziali per accedere":"Inserisci le tue credenziali per registrarti"})]}),!d&&e.jsxs("form",{onSubmit:k,className:"w-full space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx("input",{type:"email",placeholder:"Email",value:n,onChange:t=>c(t.target.value),required:!0,className:"w-full h-14 px-5 rounded-2xl bg-[#F5F5F5] dark:bg-slate-800 text-lg font-medium text-[var(--foreground)] placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#00B1FF]/50 dark:focus:bg-slate-700 transition-all shadow-[inset_0_1px_2px_rgba(0,0,0,0.03)] dark:shadow-none border border-transparent dark:border-slate-700"}),e.jsx("input",{type:"password",placeholder:"Password",value:l,onChange:t=>u(t.target.value),required:!0,className:"w-full h-14 px-5 rounded-2xl bg-[#F5F5F5] dark:bg-slate-800 text-lg font-medium text-[var(--foreground)] placeholder:text-slate-400 focus:outline-none focus:ring-2 focus:ring-[#00B1FF]/50 dark:focus:bg-slate-700 transition-all shadow-[inset_0_1px_2px_rgba(0,0,0,0.03)] dark:shadow-none border border-transparent dark:border-slate-700"})]}),x&&e.jsx("div",{className:"p-4 rounded-2xl bg-red-50 text-red-600 text-sm font-medium text-center animate-in fade-in slide-in-from-top-2",children:x}),e.jsx("button",{type:"submit",disabled:g,className:"w-full h-14 bg-[#00B1FF] hover:bg-[#0099e6] active:scale-[0.98] transition-all text-white font-bold text-[17px] rounded-full shadow-lg shadow-[#00B1FF]/20 flex items-center justify-center",children:g?r?"Accesso in corso...":"Registrazione in corso...":r?"Accedi":"Registrati"})]}),!d&&e.jsx("div",{className:"text-center space-y-4",children:e.jsx("button",{onClick:p,className:"text-[#00B1FF] font-medium text-sm hover:underline transition-all",children:r?"Non hai un account? Registrati":"Hai già un account? Accedi"})})]})]})}export{T as default};
