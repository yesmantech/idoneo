import{j as e}from"./framer-BdaCTGm4.js";import{b as G,u as Q,r as a}from"./router-ClfHAwMg.js";import{s as d}from"./index-BBBGEo7o.js";import{A as L}from"./AdminLayout-kYIYYLNk.js";import{h as M,a1 as V,a2 as X,b as Y,a3 as J,a4 as K,X as P,$ as x,R as W,a5 as Z}from"./icons-ByDj-hsa.js";import"./react-vendor-B--z-fyW.js";import"./supabase-CIvuJI4W.js";function ie(){const{id:r}=G(),j=Q(),[T,N]=a.useState(!0),[v,w]=a.useState(!1),[$,R]=a.useState(null),[n,m]=a.useState(""),[i,u]=a.useState(""),[y,F]=a.useState(!1),[h,_]=a.useState(""),[p,S]=a.useState(""),[B,C]=a.useState(""),[k,I]=a.useState(""),[z,E]=a.useState(""),[o,b]=a.useState(null),[c,g]=a.useState(null);a.useEffect(()=>{r&&D()},[r]);const D=async()=>{var l,f;N(!0);const{data:s,error:t}=await d.from("categories").select("*").eq("id",r).single();t?(alert("Errore caricamento: "+t.message),j("/admin/structure")):(R(s),m(s.home_banner_url||""),u(s.inner_banner_url||""),F(s.is_new||!1),_(((l=s.year)==null?void 0:l.toString())||""),S(((f=s.available_seats)==null?void 0:f.toString())||""),C(s.description||""),I(s.title||""),E(s.subtitle||"")),N(!1)},H=async(s,t="banners")=>{const l=s.name.split(".").pop(),U=`${`${Date.now()}_${Math.random().toString(36).substring(7)}.${l}`}`,{error:A}=await d.storage.from(t).upload(U,s);if(A)throw A;const{data:O}=d.storage.from(t).getPublicUrl(U);return O.publicUrl},q=async()=>{w(!0);try{let s=n,t=i;o&&(s=await H(o)),c&&(t=await H(c));const{error:l}=await d.from("categories").update({title:k||null,subtitle:z||null,home_banner_url:s,inner_banner_url:t,is_new:y,year:h?parseInt(h):null,available_seats:p?parseInt(p):null,description:B||null}).eq("id",r);if(l)throw l;alert("Salvato correttamente!"),b(null),g(null),m(s),u(t)}catch(s){console.error(s),alert("Errore salvataggio: "+s.message)}finally{w(!1)}};return T?e.jsx(L,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx(M,{className:"w-8 h-8 text-[#00B1FF] animate-spin"})})}):e.jsx(L,{children:e.jsxs("div",{className:"max-w-4xl mx-auto pb-20",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("button",{onClick:()=>j("/admin/structure"),className:"w-10 h-10 rounded-xl bg-white border border-slate-200 flex items-center justify-center text-slate-500 hover:text-slate-900 hover:border-slate-300 transition-all",children:e.jsx(V,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:$.title}),e.jsx("p",{className:"text-sm text-slate-500",children:"Modifica immagini e impostazioni categoria"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-[20px] border border-slate-200 p-6 shadow-[0_4px_16px_rgba(0,0,0,0.04)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-violet-50 flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-violet-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Titolo Categoria"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Nome visualizzato nella homepage e nelle pagine interne"})]})]}),e.jsx("input",{type:"text",value:k,onChange:s=>I(s.target.value),placeholder:"es. Guardia di Finanza",className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#00B1FF]/30 focus:border-[#00B1FF] transition-all text-lg font-medium"}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-500 mb-2",children:"Sottotitolo (opzionale)"}),e.jsx("input",{type:"text",value:z,onChange:s=>E(s.target.value),placeholder:"es. Concorso pubblico 2024 - 150 posti",className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#00B1FF]/30 focus:border-[#00B1FF] transition-all"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1.5",children:"Mostrato sotto il titolo nella card della homepage"})]})]}),e.jsx("div",{className:"bg-white rounded-[20px] border border-slate-200 p-6 shadow-[0_4px_16px_rgba(0,0,0,0.04)]",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-amber-50 flex items-center justify-center",children:e.jsx(Y,{className:"w-6 h-6 text-amber-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900",children:'Badge "Nuovo"'}),e.jsx("p",{className:"text-sm text-slate-500",children:"Mostra il badge NUOVO sulla card del concorso"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:y,onChange:s=>F(s.target.checked)}),e.jsx("div",{className:"w-14 h-8 bg-slate-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-[#00B1FF]/20 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[4px] after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all after:shadow-sm peer-checked:bg-[#00B1FF]"})]})]})}),e.jsx("div",{className:"bg-white rounded-[20px] border border-slate-200 p-6 shadow-[0_4px_16px_rgba(0,0,0,0.04)]",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"ðŸ“… Anno del Concorso"}),e.jsx("input",{type:"number",value:h,onChange:s=>_(s.target.value),placeholder:"es. 2024",className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#00B1FF]/30 focus:border-[#00B1FF] transition-all"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1.5",children:"L'anno mostrato sulla card"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"ðŸ‘¥ Posti Disponibili"}),e.jsx("input",{type:"number",value:p,onChange:s=>S(s.target.value),placeholder:"es. 150",className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#00B1FF]/30 focus:border-[#00B1FF] transition-all"}),e.jsx("p",{className:"text-xs text-slate-400 mt-1.5",children:"Numero di posti mostrato nel badge"})]})]})}),e.jsxs("div",{className:"bg-white rounded-[20px] border border-slate-200 p-6 shadow-[0_4px_16px_rgba(0,0,0,0.04)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-indigo-50 flex items-center justify-center",children:e.jsx(J,{className:"w-5 h-5 text-indigo-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Informazioni"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Testo mostrato nella pagina interna del concorso"})]})]}),e.jsx("textarea",{value:B,onChange:s=>C(s.target.value),placeholder:"Inserisci le informazioni sul concorso che verranno mostrate agli utenti...",rows:5,className:"w-full px-4 py-3 rounded-xl border border-slate-200 bg-slate-50 text-slate-900 placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-[#00B1FF]/30 focus:border-[#00B1FF] transition-all resize-none"}),e.jsx("p",{className:"text-xs text-slate-400 mt-2",children:'Questo testo appare nella sezione "Informazioni" della pagina del concorso'})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-[20px] border border-slate-200 p-6 shadow-[0_4px_16px_rgba(0,0,0,0.04)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-emerald-50 flex items-center justify-center",children:e.jsx(K,{className:"w-5 h-5 text-emerald-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Home Banner"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Card nella Homepage"})]})]}),e.jsx("div",{className:"mb-4",children:n?e.jsxs("div",{className:"relative group rounded-xl overflow-hidden border border-slate-200",children:[e.jsx("img",{src:n,alt:"Home Banner",className:"w-full h-40 object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsxs("button",{onClick:()=>m(""),className:"bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 hover:bg-red-600 transition-colors",children:[e.jsx(P,{className:"w-4 h-4"})," Rimuovi"]})})]}):e.jsxs("label",{className:"h-40 bg-slate-50 rounded-xl flex flex-col items-center justify-center border-2 border-dashed border-slate-200 cursor-pointer hover:border-[#00B1FF] hover:bg-slate-100 transition-all",children:[e.jsx(x,{className:"w-8 h-8 text-slate-400 mb-2"}),e.jsx("span",{className:"text-sm text-slate-500 font-medium",children:"Carica immagine"}),e.jsx("span",{className:"text-xs text-slate-400 mt-1",children:"2:1 ratio (400Ã—200px)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{var t;return b(((t=s.target.files)==null?void 0:t[0])||null)},className:"hidden"})]})}),n&&e.jsxs("label",{className:"flex items-center justify-center gap-2 py-3 px-4 bg-slate-50 rounded-xl border border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors",children:[e.jsx(x,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Sostituisci immagine"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{var t;return b(((t=s.target.files)==null?void 0:t[0])||null)},className:"hidden"})]}),o&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 px-3 py-2 bg-emerald-50 rounded-lg border border-emerald-100",children:[e.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-emerald-700 font-medium truncate",children:o.name})]})]}),e.jsxs("div",{className:"bg-white rounded-[20px] border border-slate-200 p-6 shadow-[0_4px_16px_rgba(0,0,0,0.04)]",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-sky-50 flex items-center justify-center",children:e.jsx(W,{className:"w-5 h-5 text-sky-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900",children:"Inner Header"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Header pagina concorso"})]})]}),e.jsx("div",{className:"mb-4",children:i?e.jsxs("div",{className:"relative group rounded-xl overflow-hidden border border-slate-200",children:[e.jsx("img",{src:i,alt:"Inner Banner",className:"w-full h-40 object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:e.jsxs("button",{onClick:()=>u(""),className:"bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-medium flex items-center gap-2 hover:bg-red-600 transition-colors",children:[e.jsx(P,{className:"w-4 h-4"})," Rimuovi"]})})]}):e.jsxs("label",{className:"h-40 bg-slate-50 rounded-xl flex flex-col items-center justify-center border-2 border-dashed border-slate-200 cursor-pointer hover:border-[#00B1FF] hover:bg-slate-100 transition-all",children:[e.jsx(x,{className:"w-8 h-8 text-slate-400 mb-2"}),e.jsx("span",{className:"text-sm text-slate-500 font-medium",children:"Carica immagine"}),e.jsx("span",{className:"text-xs text-slate-400 mt-1",children:"16:9 ratio (1920Ã—1080px)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{var t;return g(((t=s.target.files)==null?void 0:t[0])||null)},className:"hidden"})]})}),i&&e.jsxs("label",{className:"flex items-center justify-center gap-2 py-3 px-4 bg-slate-50 rounded-xl border border-slate-200 cursor-pointer hover:bg-slate-100 transition-colors",children:[e.jsx(x,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"text-sm text-slate-600 font-medium",children:"Sostituisci immagine"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{var t;return g(((t=s.target.files)==null?void 0:t[0])||null)},className:"hidden"})]}),c&&e.jsxs("div",{className:"mt-3 flex items-center gap-2 px-3 py-2 bg-sky-50 rounded-lg border border-sky-100",children:[e.jsx("div",{className:"w-2 h-2 bg-sky-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-xs text-sky-700 font-medium truncate",children:c.name})]})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{onClick:q,disabled:v,className:"flex items-center gap-2 bg-[#00B1FF] hover:bg-[#0099E6] text-white px-8 py-3 rounded-xl font-bold transition-all disabled:opacity-50 shadow-[0_4px_16px_rgba(0,177,255,0.3)] hover:shadow-[0_8px_24px_rgba(0,177,255,0.4)]",children:v?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-5 h-5 animate-spin"}),"Salvataggio..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-5 h-5"}),"Salva Modifiche"]})})})]})]})})}export{ie as default};
