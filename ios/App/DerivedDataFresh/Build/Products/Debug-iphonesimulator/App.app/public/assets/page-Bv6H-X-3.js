import{j as e,A as q,m as w}from"./framer-BdaCTGm4.js";import{r as N,b as B,u as D,L as y,R as k}from"./router-ClfHAwMg.js";import{s as f}from"./index-DBMi1b3R.js";import{T as E}from"./TierSLoader-BJdwavnO.js";import{l as U,b as I,Q as C,m as z,y as _,j as $,ab as L,ac as F,ad as P,G,ae as Q,e as R,a as H,X as A}from"./icons-DIoLbN6D.js";import"./react-vendor-B--z-fyW.js";import"./supabase-CIvuJI4W.js";function W(d){const[p,i]=N.useState({category:null,roles:[],candidatiCount:0,loading:!0,error:null});return N.useEffect(()=>{async function l(){try{const{data:t,error:c}=await f.from("categories").select("*").eq("slug",d).single();if(c||!t)throw new Error((c==null?void 0:c.message)||"Category not found");const{data:a,error:v}=await f.from("roles").select("*").eq("category_id",t.id).order("title");if(v)throw new Error(v.message);const x=a.map(n=>n.id),{data:o,error:m}=await f.from("quizzes").select("*").in("role_id",x).eq("is_archived",!1).order("year",{ascending:!1});if(m)throw new Error(m.message);const h=o.map(n=>n.id);let u=[];if(h.length>0){const{data:n}=await f.from("concorso_leaderboard").select("quiz_id, user_id").in("quiz_id",h);n&&(u=n)}const b=a.map(n=>{const j=o.filter(s=>s.role_id===n.id),T=j.map(s=>s.id),S=new Set(u.filter(s=>T.includes(s.quiz_id)).map(s=>s.user_id));return{id:n.id,slug:n.slug,title:n.title,categorySlug:d,activeUsers:S.size,contests:j.map(s=>({id:s.id,slug:s.slug||s.id,title:s.title,year:s.year,available_seats:s.available_seats,description:s.description||"",roleSlug:n.slug,categorySlug:d}))}}),r=new Set(u.map(n=>n.user_id)).size;i({category:{id:t.id,slug:t.slug,title:t.title,description:t.description||"",home_banner_url:t.home_banner_url||void 0,inner_banner_url:t.inner_banner_url||void 0},roles:b,candidatiCount:r,loading:!1,error:null})}catch(t){console.error("useConcorsoData error:",t),i(c=>({...c,loading:!1,error:t.message}))}}d&&l()},[d]),p}function te(){const{category:d}=B(),p=D(),{category:i,roles:l,candidatiCount:t,loading:c,error:a}=W(d||"");if(c)return e.jsx(E,{message:"Caricamento concorso..."});if(a||!i)return e.jsxs("div",{className:"min-h-screen bg-[var(--background)] flex flex-col items-center justify-center px-6",children:[e.jsx("div",{className:"text-5xl mb-4",children:"ðŸ˜•"}),e.jsx("h1",{className:"text-xl font-bold text-[var(--foreground)] mb-2",children:"Categoria non trovata"}),e.jsx("p",{className:"text-[var(--foreground)] opacity-50 text-center mb-6",children:a||"Questa categoria non esiste o Ã¨ stata rimossa."}),e.jsx(y,{to:"/",className:"text-[#00B1FF] font-semibold hover:underline",children:"â† Torna alla Home"})]});const x=(o=>{const m=o.toLowerCase();return m.includes("polizia")?{gradient:"from-cyan-400 to-blue-500",shadow:"shadow-cyan-500/20",text:"text-cyan-600",bg:"bg-cyan-50"}:m.includes("carabinieri")?{gradient:"from-blue-500 to-indigo-600",shadow:"shadow-blue-500/20",text:"text-blue-600",bg:"bg-blue-50"}:m.includes("finanza")?{gradient:"from-amber-400 to-orange-500",shadow:"shadow-amber-500/20",text:"text-amber-600",bg:"bg-amber-50"}:m.includes("esercito")?{gradient:"from-emerald-400 to-green-600",shadow:"shadow-emerald-500/20",text:"text-emerald-600",bg:"bg-emerald-50"}:m.includes("sanitÃ ")?{gradient:"from-rose-400 to-pink-600",shadow:"shadow-rose-500/20",text:"text-rose-600",bg:"bg-rose-50"}:{gradient:"from-slate-400 to-slate-600",shadow:"shadow-slate-500/20",text:"text-slate-600",bg:"bg-slate-50"}})(i.title);return e.jsxs("div",{className:"min-h-screen bg-[var(--background)] pb-24 transition-colors duration-300",children:[e.jsxs("div",{className:"relative h-[35vh] min-h-[300px] md:h-[45vh] md:min-h-[380px] overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0",children:[i.inner_banner_url?e.jsx("img",{src:i.inner_banner_url,alt:i.title,className:"w-full h-full object-cover animate-in fade-in zoom-in duration-1000 scale-[1.02]"}):e.jsx("div",{className:`w-full h-full bg-gradient-to-br ${x.gradient}`}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 h-3/4 bg-gradient-to-t from-[var(--background)] via-[var(--background)]/80 to-transparent"}),e.jsx("div",{className:"absolute inset-0 bg-black/10"})]}),e.jsx("div",{className:"absolute top-0 left-0 right-0 z-20 pt-safe px-4",children:e.jsx("div",{className:"h-14 flex items-center justify-between",children:e.jsx("button",{onClick:()=>p(-1),className:"w-10 h-10 flex items-center justify-center rounded-full bg-white/20 backdrop-blur-md text-slate-900 border border-white/30 hover:bg-white/40 transition-all shadow-sm",children:e.jsx(U,{className:"w-6 h-6"})})})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 z-10 px-6 pb-12 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-1.5 px-3 py-1 rounded-full bg-[var(--card)]/60 backdrop-blur-md border border-[var(--card-border)] shadow-sm mb-4",children:[e.jsx(I,{className:`w-3.5 h-3.5 ${x.text}`,fill:"currentColor"}),e.jsx("span",{className:`text-[11px] font-bold uppercase tracking-wider ${x.text}`,children:"Concorsi Pubblici 2025"})]}),e.jsx("h1",{className:"text-3xl md:text-5xl font-black text-[var(--foreground)] tracking-tight leading-[1.1] mb-3 drop-shadow-sm",children:i.title}),e.jsx("p",{className:"text-[14px] md:text-[15px] font-medium text-[var(--foreground)] opacity-60 max-w-md mx-auto leading-relaxed line-clamp-2",children:i.description||"Preparati al meglio per i concorsi di questa categoria con simulazioni ufficiali e materiali dedicati."})]})]}),e.jsxs("main",{className:"px-4 md:px-8 max-w-7xl mx-auto -mt-6 relative z-20 space-y-8",children:[e.jsx(X,{theme:x,candidatiCount:t,availableSeats:i.available_seats}),e.jsxs("section",{className:"flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("h2",{className:"text-[17px] md:text-[19px] font-bold text-[var(--foreground)] flex items-center gap-2",children:[e.jsx(Y,{}),"Scegli il tuo profilo"]}),e.jsxs("span",{className:"text-[11px] md:text-[13px] font-medium text-[var(--foreground)] opacity-50 bg-[var(--card)] px-2.5 py-1 rounded-full shadow-sm border border-[var(--card-border)]",children:[l.length," disponibili"]})]}),e.jsx("div",{className:"flex flex-col gap-3",children:l.length>0?l.map(o=>{var u,b;o.title.split(" ").map(g=>g[0]).join("").substring(0,2).toUpperCase();const h=(g=>{const r=g.toLowerCase();return r.includes("sanitÃ ")||r.includes("infermier")||r.includes("medic")?L:r.includes("finanza")||r.includes("banca")||r.includes("econom")?F:r.includes("amministra")||r.includes("comun")||r.includes("regione")?P:r.includes("giustizia")||r.includes("magistrat")?G:r.includes("scuola")||r.includes("docent")?Q:r.includes("patente")||r.includes("guida")?R:H})(i.title);return e.jsxs(y,{to:`/concorsi/${d}/${o.slug}`,className:"group relative bg-white dark:bg-[#1e2330] p-4 rounded-[24px] shadow-sm border border-slate-200/60 dark:border-[var(--card-border)] transition-all duration-300 hover:shadow-md dark:hover:bg-[#252b3b] overflow-hidden flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full border border-sky-100 dark:border-sky-500/20 bg-sky-50 dark:bg-[#141820] flex items-center justify-center shrink-0",children:e.jsx(h,{className:"w-5 h-5 text-sky-500 dark:text-sky-400"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-[16px] font-bold text-slate-900 dark:text-white mb-2 leading-snug truncate",children:o.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-slate-100 dark:bg-[#141820] border border-slate-200 dark:border-white/5",children:[e.jsx(C,{className:"w-3.5 h-3.5 text-slate-400"}),e.jsxs("span",{className:"text-[12px] font-medium text-slate-600 dark:text-slate-300",children:[o.activeUsers||0," ",e.jsx("span",{className:"hidden sm:inline text-slate-400 dark:text-slate-500",children:"attivi"})]})]}),((u=o.contests[0])==null?void 0:u.available_seats)&&e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-emerald-50 dark:bg-emerald-500/10 border border-emerald-100 dark:border-emerald-500/20",children:[e.jsx(z,{className:"w-3.5 h-3.5 text-emerald-500 dark:text-emerald-400"}),e.jsxs("span",{className:"text-[12px] font-medium text-emerald-600 dark:text-emerald-400",children:[o.contests[0].available_seats," ",e.jsx("span",{className:"hidden sm:inline",children:"posti"})]})]}),((b=o.contests[0])==null?void 0:b.year)&&e.jsxs("div",{className:"hidden sm:flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-purple-50 dark:bg-purple-500/10 border border-purple-100 dark:border-purple-500/20",children:[e.jsx(_,{className:"w-3.5 h-3.5 text-purple-500 dark:text-purple-400"}),e.jsx("span",{className:"text-[12px] font-medium text-purple-600 dark:text-purple-400",children:o.contests[0].year})]})]})]}),e.jsx("div",{className:"text-slate-300 dark:text-slate-500 group-hover:text-slate-600 dark:group-hover:text-white transition-colors",children:e.jsx($,{className:"w-5 h-5"})})]},o.id)}):e.jsxs("div",{className:"py-12 text-center bg-[var(--card)] rounded-[32px] border border-[var(--card-border)] border-dashed",children:[e.jsx("div",{className:"text-4xl mb-4 opacity-50",children:"ðŸ“­"}),e.jsx("p",{className:"text-[var(--foreground)] opacity-60 font-medium",children:"Nessun ruolo disponibile per questa categoria al momento."})]})})]})]})]})}function X({theme:d,candidatiCount:p,availableSeats:i}){const[l,t]=k.useState(null),c=[{id:"candidati",value:p,label:"Candidati",icon:C,themeBg:d.bg,themeText:d.text,description:"Il numero totale di utenti unici che hanno partecipato alle simulazioni per i concorsi di questa categoria."},{id:"posti",value:i||"N/D",label:"Posti Totali",icon:z,themeBg:"bg-emerald-50 dark:bg-emerald-900/30",themeText:"text-emerald-600 dark:text-emerald-400",description:"Il numero complessivo di posti messi a bando per i concorsi attivi in questa categoria."},{id:"edizione",value:new Date().getFullYear(),label:"Edizione",icon:_,themeBg:"bg-purple-50 dark:bg-purple-900/30",themeText:"text-purple-600 dark:text-purple-400",description:"L'anno di riferimento per i concorsi attualmente mostrati in questa sezione."}];return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"flex md:grid md:grid-cols-3 gap-2.5 md:gap-4 overflow-x-auto md:overflow-visible pb-4 md:pb-0 -mx-4 md:mx-0 px-4 md:px-0 scrollbar-hide snap-x md:snap-none",children:c.map(a=>e.jsxs("div",{onClick:()=>t({title:a.label,desc:a.description,icon:a.icon,themeBg:a.themeBg,themeText:a.themeText}),className:"cursor-pointer active:scale-95 transition-transform snap-start flex-1 min-w-[100px] md:w-auto bg-[var(--card)] rounded-2xl p-3 md:p-5 shadow-soft border border-[var(--card-border)] flex flex-col items-center justify-center gap-1 md:gap-2 hover:border-[#00B1FF]/30",children:[e.jsx("div",{className:`w-7 h-7 md:w-10 md:h-10 rounded-full ${a.themeBg} flex items-center justify-center mb-1`,children:e.jsx(a.icon,{className:`w-3.5 h-3.5 md:w-5 md:h-5 ${a.themeText}`})}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"block text-xl md:text-3xl font-bold text-[var(--foreground)] leading-none mb-1",children:a.value}),e.jsx("span",{className:"block text-[10px] md:text-[12px] font-semibold text-[var(--foreground)] opacity-50 uppercase tracking-wide",children:a.label})]})]},a.id))}),e.jsx(q,{children:l&&e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-6 px-8",children:[e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>t(null),className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),e.jsxs(w.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},className:"relative bg-[var(--card)] border border-[var(--card-border)] rounded-[24px] p-6 max-w-sm w-full shadow-2xl text-center",children:[e.jsx("button",{onClick:()=>t(null),className:"absolute top-4 right-4 p-2 bg-[var(--background)] rounded-full text-[var(--foreground)] opacity-50 hover:opacity-100 transition-colors",children:e.jsx(A,{className:"w-5 h-5"})}),e.jsx("div",{className:`w-16 h-16 rounded-2xl ${l.themeBg} flex items-center justify-center mx-auto mb-4`,children:k.createElement(l.icon,{className:`w-8 h-8 ${l.themeText}`})}),e.jsx("h3",{className:"text-xl font-bold text-[var(--foreground)] mb-2",children:l.title}),e.jsx("p",{className:"text-[var(--foreground)] opacity-70 text-[15px] leading-relaxed mb-6",children:l.desc}),e.jsx("button",{onClick:()=>t(null),className:"w-full py-3 bg-[var(--foreground)] text-[var(--background)] rounded-xl font-bold hover:opacity-90 transition-opacity",children:"Ho capito"})]})]})})]})}function Y(){return e.jsxs("svg",{className:"w-5 h-5 text-slate-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[e.jsx("rect",{x:"3",y:"3",width:"7",height:"7",rx:"2"}),e.jsx("rect",{x:"14",y:"3",width:"7",height:"7",rx:"2"}),e.jsx("rect",{x:"14",y:"14",width:"7",height:"7",rx:"2"}),e.jsx("rect",{x:"3",y:"14",width:"7",height:"7",rx:"2"})]})}export{te as default};
