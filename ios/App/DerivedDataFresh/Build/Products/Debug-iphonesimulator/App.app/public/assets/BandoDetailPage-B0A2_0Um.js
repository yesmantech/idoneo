import{j as e,m as i}from"./framer-CcO5Kjcw.js";import{b as L,u as E,r as b,L as P}from"./router-ClfHAwMg.js";import{f as z,i as M,E as T,u as A,s as I}from"./bandiService-BZw1T8K1.js";import{B as R}from"./BandoSkeleton-DvN1ofUN.js";import{u as F,e as H}from"./index-Z19V86or.js";import{R as O,H as V,a as G,y as U,o as q,q as W,V as Y,M as J,W as K,Y as Q,_ as X,$ as Z,a0 as ee,a1 as ae}from"./icons-Dvxa2Qho.js";import"./react-vendor-B--z-fyW.js";import"./supabase-CIvuJI4W.js";function xe(){var f,j,w,v,y,N,k;const{slug:t}=L(),r=E(),{user:s}=F(),[a,n]=b.useState(null),[c,h]=b.useState(!0),[m,p]=b.useState(!1),[x,B]=b.useState(!1);b.useEffect(()=>{t&&$(t)},[t]);const $=async l=>{h(!0);const d=await z(l);n(d),d&&s&&p(await M(d.id)),h(!1)},D=async()=>{if(!a||!s)return;H(),(m?await A(a.id):await I(a.id))&&p(!m)};if(c)return e.jsx(R,{variant:"detail"});if(!a)return e.jsx(te,{});const o=a.days_remaining??0,g=Math.min(100,Math.max(0,(30-o)/30*100));return e.jsxs("div",{className:"min-h-screen bg-canvas-light dark:bg-slate-950 font-sans pb-32",children:[e.jsx("div",{className:"sticky top-0 z-40 bg-white/70 dark:bg-slate-950/70 backdrop-blur-xl border-b border-slate-200/50 dark:border-white/5 data-[scrolled=true]:shadow-soft transition-all",children:e.jsxs("div",{className:"flex items-center justify-between px-4 h-14 max-w-lg mx-auto",children:[e.jsx("button",{onClick:()=>r(-1),className:"p-2 -ml-2 rounded-full hover:bg-slate-100 dark:hover:bg-white/10 text-slate-500 dark:text-slate-400 dark:hover:text-white transition-all",children:e.jsx(O,{className:"w-6 h-6"})}),e.jsx("span",{className:"font-bold text-lg bg-gradient-to-r from-brand-blue to-brand-cyan bg-clip-text text-transparent",children:"Dettagli Concorso"}),e.jsx("button",{onClick:D,className:"p-2 -mr-2 rounded-full hover:bg-slate-100 dark:hover:bg-white/10 transition-all",children:e.jsx(V,{className:`w-6 h-6 transition-colors ${m?"fill-semantic-error text-semantic-error":"text-slate-400"}`})})]})}),e.jsxs("div",{className:"px-4 py-6 space-y-6 max-w-lg mx-auto relative z-10",children:[e.jsxs(i.div,{initial:{opacity:0,y:20,scale:.95},animate:{opacity:1,y:0,scale:1},className:"relative overflow-hidden rounded-[32px] bg-slate-900 border border-white/10 shadow-2xl p-6 text-center group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-brand-cyan/20 blur-[80px] rounded-full -mr-20 -mt-20 group-hover:bg-brand-cyan/30 transition-all duration-700"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-brand-purple/20 blur-[80px] rounded-full -ml-20 -mb-20 group-hover:bg-brand-purple/30 transition-all duration-700"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsx(i.div,{whileHover:{scale:1.05,rotate:2},className:"w-20 h-20 bg-white rounded-[22px] flex items-center justify-center shadow-card mb-5 p-3 overflow-hidden",children:(f=a.ente)!=null&&f.logo_url?e.jsx("img",{src:a.ente.logo_url,className:"w-full h-full object-contain",alt:"Logo"}):e.jsx(G,{className:"w-10 h-10 text-brand-blue"})}),e.jsx("h1",{className:"text-2xl font-bold text-white mb-2 leading-tight",children:a.title}),e.jsx("p",{className:"text-brand-cyan font-medium text-sm mb-6 bg-brand-cyan/10 px-3 py-1 rounded-full border border-brand-cyan/20",children:(j=a.ente)==null?void 0:j.name}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full",children:[e.jsx(S,{label:"Pubblicato",date:a.publication_date,color:"blue",icon:U}),e.jsx(S,{label:"Scadenza",date:a.deadline,color:o<7?"orange":"cyan",icon:q})]})]})]}),e.jsxs(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.15},className:"relative rounded-[24px] bg-white dark:bg-slate-900/50 backdrop-blur-xl border border-slate-200 dark:border-white/10 p-5 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-end mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-xs font-bold uppercase tracking-wider mb-1",children:"Stato attuale"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`flex h-3 w-3 rounded-full ${o>0?"bg-semantic-success animate-pulse":"bg-semantic-error"}`}),e.jsx("span",{className:"text-slate-900 dark:text-white font-bold text-lg",children:o>0?`Scade tra ${o} giorni`:"Scaduto"})]})]}),e.jsxs("span",{className:"text-2xl font-black text-slate-200 dark:text-white/10",children:[g.toFixed(0),"%"]})]}),e.jsx("div",{className:"h-3 bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx(i.div,{initial:{width:0},animate:{width:`${g}%`},transition:{duration:1,ease:"easeOut"},className:`h-full rounded-full shadow-[0_0_10px_rgba(6,214,211,0.5)] bg-gradient-to-r ${o>7?"from-brand-blue to-brand-cyan":"from-brand-orange to-semantic-error"}`})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx(u,{icon:W,label:"Categoria",value:(w=a.category)==null?void 0:w.name,delay:.2,color:"text-brand-purple",bg:"bg-brand-purple/10"}),e.jsx(u,{icon:Y,label:"Titolo",value:a.education_level&&((v=T.find(l=>{var d;return l.value===((d=a.education_level)==null?void 0:d[0])}))==null?void 0:v.label),delay:.3,color:"text-brand-blue",bg:"bg-brand-blue/10"}),e.jsx(u,{icon:J,label:"Luogo",value:a.city||a.province||"Nazionale",delay:.4,color:"text-brand-orange",bg:"bg-brand-orange/10"})]}),e.jsxs(i.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"bg-white dark:bg-slate-900/50 backdrop-blur-sm rounded-[24px] p-6 border border-slate-200 dark:border-white/5",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-3",children:"Descrizione"}),e.jsxs("div",{className:`relative overflow-hidden transition-all duration-500 ease-ios ${x?"max-h-[1000px]":"max-h-32"}`,children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-300 leading-relaxed whitespace-pre-line text-[15px]",children:a.description||a.short_description}),!x&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-16 bg-gradient-to-t from-white dark:from-slate-900 to-transparent"})]}),e.jsxs("button",{onClick:()=>B(!x),className:"mt-2 w-full flex items-center justify-center gap-2 py-2 text-brand-blue font-semibold text-sm hover:bg-brand-blue/5 rounded-xl transition-colors",children:[x?"Mostra meno":"Leggi tutto",e.jsx(K,{className:`w-4 h-4 transition-transform ${x?"rotate-180":""}`})]})]}),e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},className:"space-y-3",children:[a.application_url&&e.jsx(_,{icon:Q,label:"Vai al sito ufficiale",href:a.application_url,highlight:!0}),((y=a.documents)==null?void 0:y.find(l=>l.type==="bando"))&&e.jsx(_,{icon:X,label:"Scarica Bando PDF",href:((N=a.documents.find(l=>l.type==="bando"))==null?void 0:N.file_url)||"#"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx(C,{icon:Z,label:"Invia PEC",href:`mailto:${((k=a.ente)==null?void 0:k.website)||""}`}),e.jsx(C,{icon:ee,label:"Condividi",onClick:()=>{navigator.share&&navigator.share({title:a.title,url:window.location.href})}})]})]})]})]})}function S({label:t,date:r,color:s,icon:a}){if(!r)return null;const n=new Date(r).toLocaleDateString("it-IT",{day:"numeric",month:"short",year:"numeric"}),c={cyan:"bg-brand-cyan/10 border-brand-cyan/20 text-brand-cyan",blue:"bg-brand-blue/10 border-brand-blue/20 text-brand-blue",orange:"bg-brand-orange/10 border-brand-orange/20 text-brand-orange"};return e.jsxs("div",{className:`flex flex-col items-center justify-center p-3 rounded-2xl border ${c[s]}`,children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1 opacity-80",children:[e.jsx(a,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-wider",children:t})]}),e.jsx("span",{className:"text-white font-bold text-sm bg-slate-900/40 px-2 py-1 rounded-lg w-full text-center",children:n})]})}function u({icon:t,label:r,value:s,delay:a,color:n,bg:c}){return e.jsx(i.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:a,type:"spring",stiffness:300},className:"flex flex-col items-center p-4 rounded-[24px] bg-white dark:bg-slate-900/60 border border-slate-100 dark:border-white/5 shadow-soft text-center h-full min-h-[140px]",children:e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-start pt-2",children:[e.jsx("div",{className:`w-12 h-12 rounded-[18px] ${c} ${n} flex items-center justify-center mb-3`,children:e.jsx(t,{className:"w-6 h-6"})}),e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1.5",children:r}),e.jsx("p",{className:"text-sm font-bold text-slate-900 dark:text-white leading-tight line-clamp-2",children:s||"-"})]})})}function _({icon:t,label:r,href:s,highlight:a}){return e.jsxs("a",{href:s,target:"_blank",rel:"noopener",className:`flex items-center justify-between p-4 rounded-[24px] border transition-all active:scale-[0.98]
                ${a?"bg-brand-blue text-white border-brand-blue shadow-lg shadow-brand-blue/20":"bg-white dark:bg-slate-800/50 text-slate-700 dark:text-white border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("span",{className:"font-bold",children:r})]}),e.jsx(ae,{className:"w-4 h-4 opacity-70"})]})}function C({icon:t,label:r,href:s,onClick:a}){const n=s?"a":"button";return e.jsxs(n,{href:s,onClick:a,className:"flex flex-col items-center justify-center gap-2 p-4 rounded-[24px] bg-white dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[e.jsx(t,{className:"w-6 h-6 text-slate-400"}),e.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300",children:r})]})}function te(){return e.jsxs("div",{className:"min-h-screen bg-canvas-light dark:bg-slate-950 flex flex-col items-center justify-center p-6 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:"Bando non trovato ðŸ˜”"}),e.jsx(P,{to:"/bandi",className:"text-brand-blue font-bold hover:underline",children:"Torna alla lista"})]})}export{xe as default};
