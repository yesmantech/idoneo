import{j as e}from"./framer-CcO5Kjcw.js";import{b as V,u as Z,r as m}from"./router-ClfHAwMg.js";import{S as U}from"./blog-CvfiCAga.js";import{s as h}from"./index-BcNl-kiB.js";import{A as M}from"./AdminLayout-BOgckf8M.js";import"./react-vendor-B--z-fyW.js";import"./supabase-CIvuJI4W.js";import"./icons-Dvxa2Qho.js";const K={title:"",subtitle:"",slug:"",status:"draft",categoryId:"",selectedTags:[],coverImageUrl:"",content:[],publishedAt:"",isFeatured:!1,seoTitle:"",seoDescription:"",canonicalUrl:"",isNoindex:!1};function R(t){return t.toLowerCase().replace(/[Ã Ã¡Ã¢Ã£Ã¤Ã¥]/g,"a").replace(/[Ã¨Ã©ÃªÃ«]/g,"e").replace(/[Ã¬Ã­Ã®Ã¯]/g,"i").replace(/[Ã²Ã³Ã´ÃµÃ¶]/g,"o").replace(/[Ã¹ÃºÃ»Ã¼]/g,"u").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").trim()}function $(t){let s=0;for(const a of t)switch(a.type){case"paragraph":case"heading":s+=a.text.split(/\s+/).filter(Boolean).length;break;case"list":for(const o of a.items)s+=o.split(/\s+/).filter(Boolean).length;break;case"callout":s+=a.text.split(/\s+/).filter(Boolean).length,s+=a.title.split(/\s+/).filter(Boolean).length;break;case"faq":for(const o of a.items)s+=o.question.split(/\s+/).filter(Boolean).length,s+=o.answer.split(/\s+/).filter(Boolean).length;break;case"cta":s+=a.title.split(/\s+/).filter(Boolean).length,s+=a.description.split(/\s+/).filter(Boolean).length;break}return Math.max(1,Math.ceil(s/200))}function X(t){switch(t){case"paragraph":return{type:"paragraph",text:""};case"heading":return{type:"heading",level:2,text:""};case"list":return{type:"list",ordered:!1,items:[""]};case"callout":return{type:"callout",variant:"tip",title:"",text:""};case"faq":return{type:"faq",items:[{question:"",answer:""}]};case"cta":return{type:"cta",title:"",description:"",buttonText:"",buttonUrl:""};default:return null}}function Y(){const{id:t}=V(),s=Z(),a=!t||t==="nuovo",[o,u]=m.useState(K),[g,d]=m.useState([]),[l,p]=m.useState([]),[x,v]=m.useState(!a),[I,w]=m.useState(!1),[A,C]=m.useState(!1),k=m.useCallback((r,c)=>{u(n=>({...n,[r]:c}))},[]),y=m.useCallback(r=>{u(c=>{const n=a||c.slug===R(c.title);return{...c,title:r,slug:n?R(r):c.slug}})},[a]);m.useEffect(()=>{(async()=>{try{const[c,n]=await Promise.all([h.from("blog_categories").select("*").order("sort_order"),h.from("blog_tags").select("*").order("name")]);if(c.error)throw c.error;if(n.error)throw n.error;if(c.data&&d(c.data),n.data&&p(n.data),!a&&t){const{data:i,error:b}=await h.from("blog_posts").select("*").eq("id",t).single();if(b)throw b;i&&u({title:i.title,subtitle:i.subtitle||"",slug:i.slug,status:i.status,categoryId:i.category_id||"",coverImageUrl:i.cover_image_url||"",content:i.content||[],publishedAt:i.published_at?i.published_at.slice(0,16):"",isFeatured:i.is_featured,seoTitle:i.seo_title||"",seoDescription:i.seo_description||"",canonicalUrl:i.canonical_url||"",isNoindex:i.is_noindex,selectedTags:[]});const{data:N}=await h.from("blog_post_tags").select("tag_id").eq("post_id",t);N&&u(_=>({..._,selectedTags:N.map(L=>L.tag_id)}))}}catch(c){console.error("Failed to load blog editor data:",c),alert("Errore durante il caricamento dei dati.")}finally{v(!1)}})()},[t,a]);const E=m.useCallback(async()=>{const{title:r,slug:c,status:n,categoryId:i,coverImageUrl:b,content:N,publishedAt:_,isFeatured:L,subtitle:G,seoTitle:J,seoDescription:W,canonicalUrl:H,isNoindex:Q,selectedTags:q}=o;if(!r.trim()){alert("Il titolo Ã¨ obbligatorio");return}if(!c.trim()){alert("Lo slug Ã¨ obbligatorio");return}w(!0);const D={title:r,subtitle:G||null,slug:c,status:n,category_id:i||null,cover_image_url:b||null,content:N,reading_time_minutes:$(N),published_at:n==="published"&&!_?new Date().toISOString():_||null,is_featured:L,seo_title:J||null,seo_description:W||null,canonical_url:H||null,is_noindex:Q,updated_at:new Date().toISOString()};try{let j=t;if(a){const{data:f,error:S}=await h.from("blog_posts").insert(D).select("id").single();if(S)throw S;j=f.id}else{const{error:f}=await h.from("blog_posts").update(D).eq("id",t);if(f)throw f}if(j&&(await h.from("blog_post_tags").delete().eq("post_id",j),q.length>0)){const{error:f}=await h.from("blog_post_tags").insert(q.map(S=>({post_id:j,tag_id:S})));if(f)throw f}alert("Articolo salvato con successo!"),s("/admin/blog")}catch(j){console.error("Save error:",j);const f=j instanceof Error?j.message:"Errore sconosciuto";alert(`Errore: ${f}`)}finally{w(!1)}},[o,t,a,s]),B=m.useCallback(async r=>{if(!r.type.startsWith("image/")){alert("Per favore seleziona un file immagine (JPG, PNG, WebP)");return}const c=5*1024*1024;if(r.size>c){alert("Il file Ã¨ troppo grande (max 5MB)");return}C(!0);try{const n=r.name.split(".").pop(),i=`${Date.now()}_${r.name.replace(/[^a-zA-Z0-9]/g,"_")}.${n}`,{error:b}=await h.storage.from("blog-images").upload(i,r);if(b)throw b;const{data:{publicUrl:N}}=h.storage.from("blog-images").getPublicUrl(i);k("coverImageUrl",N)}catch(n){console.error("Upload error:",n);const i=n instanceof Error?n.message:'Controlla che il bucket "blog-images" esista e sia pubblico';alert(`Errore durante il caricamento: ${i}`)}finally{C(!1)}},[k]),T=m.useCallback(r=>{const c=X(r);c&&u(n=>({...n,content:[...n.content,c]}))},[]),z=m.useCallback((r,c)=>{u(n=>{const i=[...n.content];return i[r]={...i[r],...c},{...n,content:i}})},[]),P=m.useCallback(r=>{u(c=>({...c,content:c.content.filter((n,i)=>i!==r)}))},[]),O=m.useCallback((r,c)=>{const n=c==="up"?r-1:r+1;u(i=>{if(n<0||n>=i.content.length)return i;const b=[...i.content];return[b[r],b[n]]=[b[n],b[r]],{...i,content:b}})},[]);return{formState:o,categories:g,allTags:l,isNew:a,loading:x,saving:I,uploading:A,updateField:k,handleTitleChange:y,handleSave:E,handleImageUpload:B,addBlock:T,updateBlock:z,removeBlock:P,moveBlock:O,navigate:s}}function ee({isOpen:t,onClose:s,onImport:a}){const[o,u]=m.useState(""),[g,d]=m.useState("");if(!t)return null;const l=()=>{try{d("");const p=JSON.parse(o);if(!p.title)throw new Error("Manca il campo 'title'");if(!Array.isArray(p.content))throw new Error("Il campo 'content' deve essere una lista");const x=p.content.map(v=>{if(!v.type)throw new Error("Blocco senza 'type'");return v});a({...p,content:x,tags:p.tags||[]}),s(),u("")}catch(p){d(p.message||"JSON non valido")}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-[var(--card)] border border-[var(--card-border)] rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"p-6 border-b border-[var(--card-border)] flex justify-between items-center bg-slate-50 dark:bg-slate-900/50 rounded-t-xl",children:[e.jsx("h3",{className:"font-bold text-xl text-[var(--foreground)]",children:"ðŸ¤– Importa da AI Script"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(te),alert("Prompt copiato! Incollalo su ChatGPT.")},className:"text-xs bg-indigo-100 text-indigo-700 font-bold px-3 py-1 rounded-full hover:bg-indigo-200 transition-colors",children:"ðŸ“‹ Copia Prompt"}),e.jsx("button",{onClick:s,className:"text-[var(--foreground)] opacity-40 hover:opacity-100 font-bold text-xl ml-2 transition-all",children:"Ã—"})]})]}),e.jsxs("div",{className:"p-6 flex-1 overflow-y-auto space-y-4",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-500/10 text-blue-800 dark:text-blue-400 p-4 rounded-lg text-sm border border-blue-100 dark:border-blue-500/20",children:"Incolla qui il JSON generato da ChatGPT. Assicurati che segua lo schema richiesto."}),e.jsx("textarea",{value:o,onChange:p=>u(p.target.value),placeholder:'{ "title": "...", "content": [...] }',className:"w-full h-64 p-4 font-mono text-sm bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:ring-2 focus:ring-emerald-500 focus:outline-none placeholder-[var(--foreground)]/20"}),g&&e.jsxs("div",{className:"bg-rose-50 text-rose-600 p-3 rounded-lg text-sm font-medium border border-rose-100",children:["âŒ Errore: ",g]})]}),e.jsxs("div",{className:"p-6 border-t border-[var(--card-border)] bg-slate-50 dark:bg-slate-900/50 rounded-b-xl flex justify-end gap-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-[var(--foreground)] opacity-60 hover:bg-slate-200 dark:hover:bg-slate-800 rounded-lg font-medium transition-colors",children:"Annulla"}),e.jsx("button",{onClick:l,disabled:!o.trim(),className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold shadow-lg shadow-emerald-500/20 disabled:opacity-50 disabled:shadow-none transition-all",children:"Importa Articolo"})]})]})})}const te=`
Agisci come un esperto copywriter SEO e crea un articolo di blog strutturato.
Rispondi SOLO con un oggetto JSON valido (nessun markdown, nessun testo prima/dopo) che segua esattamente questo schema:

{
  "title": "Titolo Accattivante",
  "subtitle": "Sottotitolo persuasivo",
  "category": "Nome Categoria (es. Concorsi, Studio, News)",
  "tags": ["Tag1", "Tag2"],
  "content": [
    { "type": "paragraph", "text": "Testo introduttivo..." },
    { "type": "heading", "level": 2, "text": "Titolo Sezione" },
    { "type": "paragraph", "text": "Contenuto sezione..." },
    { "type": "list", "ordered": false, "items": ["Punto 1", "Punto 2"] },
    { "type": "callout", "variant": "tip", "title": "Consiglio", "text": "Testo del consiglio" },
    { "type": "faq", "items": [{ "question": "Domanda?", "answer": "Risposta." }] },
    { "type": "cta", "title": "Titolo CTA", "description": "Descrizione", "buttonText": "Bottone", "buttonUrl": "https://..." }
  ],
  "seo_title": "Titolo ottimizzato SEO (max 60 car)",
  "seo_description": "Meta description ottimizzata (max 160 car)",
  "slug": "slug-articolo-ottimizzato"
}
`;function re({index:t,type:s,isFirst:a,isLast:o,onMove:u,onRemove:g,children:d}){return e.jsxs("div",{className:"border border-slate-200 dark:border-slate-700 rounded-lg p-4 relative group",children:[e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>u(t,"up"),disabled:a,className:"p-1 text-slate-400 hover:text-[var(--foreground)] disabled:opacity-30","aria-label":"Move up",children:"â†‘"}),e.jsx("button",{onClick:()=>u(t,"down"),disabled:o,className:"p-1 text-slate-400 hover:text-[var(--foreground)] disabled:opacity-30","aria-label":"Move down",children:"â†“"}),e.jsx("button",{onClick:()=>g(t),className:"p-1 text-rose-400 hover:text-rose-600","aria-label":"Remove block",children:"âœ•"})]}),e.jsx("div",{className:"text-xs font-bold text-[var(--foreground)] opacity-30 uppercase mb-2",children:s}),d]})}function ae({text:t,onChange:s}){return e.jsx("textarea",{value:t,onChange:a=>s(a.target.value),placeholder:"Scrivi il testo...",className:"w-full p-3 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] opacity-80 min-h-[100px] resize-y focus:outline-none focus:ring-1 focus:ring-emerald-500/50"})}function oe({level:t,text:s,onChangeLevel:a,onChangeText:o}){return e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:t,onChange:u=>a(parseInt(u.target.value)),className:"px-2 py-1 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)]",children:[e.jsx("option",{value:2,children:"H2"}),e.jsx("option",{value:3,children:"H3"})]}),e.jsx("input",{type:"text",value:s,onChange:u=>o(u.target.value),placeholder:"Titolo sezione...",className:"flex-1 p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded font-bold text-[var(--foreground)] focus:outline-none"})]})}function se({ordered:t,items:s,onChangeOrdered:a,onChangeItems:o}){const u=(l,p)=>{const x=[...s];x[l]=p,o(x)},g=l=>{const p=s.filter((x,v)=>v!==l);o(p.length>0?p:[""])},d=()=>{o([...s,""])};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:t,onChange:l=>a(l.target.checked),className:"rounded"}),"Lista numerata"]}),s.map((l,p)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[var(--foreground)] opacity-30 pt-2 w-6 text-right",children:t?`${p+1}.`:"â€¢"}),e.jsx("input",{type:"text",value:l,onChange:x=>u(p,x.target.value),placeholder:"Elemento lista...",className:"flex-1 p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)]"}),e.jsx("button",{onClick:()=>g(p),className:"p-2 text-rose-400 hover:text-rose-600","aria-label":"Remove item",children:"âœ•"})]},p)),e.jsx("button",{onClick:d,className:"text-sm text-emerald-600 hover:text-emerald-700",children:"+ Aggiungi elemento"})]})}function le({variant:t,title:s,text:a,onChangeVariant:o,onChangeTitle:u,onChangeText:g}){return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("select",{value:t,onChange:d=>o(d.target.value),className:"px-2 py-1 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)]",children:[e.jsx("option",{value:"tip",children:"ðŸ’¡ Tip"}),e.jsx("option",{value:"warning",children:"âš ï¸ Warning"}),e.jsx("option",{value:"note",children:"ðŸ“ Nota"}),e.jsx("option",{value:"example",children:"ðŸ“Œ Esempio"})]}),e.jsx("input",{type:"text",value:s,onChange:d=>u(d.target.value),placeholder:"Titolo callout...",className:"w-full p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded font-medium text-[var(--foreground)]"}),e.jsx("textarea",{value:a,onChange:d=>g(d.target.value),placeholder:"Contenuto callout...",className:"w-full p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)] opacity-80"})]})}function ne({items:t,onChangeItems:s}){const a=(g,d,l)=>{const p=[...t];p[g]={...p[g],[d]:l},s(p)},o=g=>{const d=t.filter((l,p)=>p!==g);s(d.length>0?d:[{question:"",answer:""}])},u=()=>{s([...t,{question:"",answer:""}])};return e.jsxs("div",{className:"space-y-4",children:[t.map((g,d)=>e.jsxs("div",{className:"border border-slate-100 dark:border-slate-800 rounded-lg p-3 bg-slate-50 dark:bg-slate-900/50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"text-xs font-bold text-[var(--foreground)] opacity-30",children:["FAQ #",d+1]}),e.jsx("button",{onClick:()=>o(d),className:"text-rose-400 hover:text-rose-600 text-sm",children:"âœ• Rimuovi"})]}),e.jsx("input",{type:"text",value:g.question,onChange:l=>a(d,"question",l.target.value),placeholder:"Domanda...",className:"w-full p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded mb-2 font-medium text-[var(--foreground)]"}),e.jsx("textarea",{value:g.answer,onChange:l=>a(d,"answer",l.target.value),placeholder:"Risposta...",className:"w-full p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded min-h-[60px] text-[var(--foreground)] opacity-80"})]},d)),e.jsx("button",{onClick:u,className:"text-sm text-emerald-600 hover:text-emerald-700",children:"+ Aggiungi domanda"})]})}function ie({title:t,description:s,buttonText:a,buttonUrl:o,onChange:u}){return e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",value:t,onChange:g=>u("title",g.target.value),placeholder:"Titolo CTA...",className:"p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)]"}),e.jsx("input",{type:"text",value:a,onChange:g=>u("buttonText",g.target.value),placeholder:"Testo pulsante...",className:"p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)]"}),e.jsx("input",{type:"text",value:s,onChange:g=>u("description",g.target.value),placeholder:"Descrizione...",className:"p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)] opacity-80"}),e.jsx("input",{type:"text",value:o,onChange:g=>u("buttonUrl",g.target.value),placeholder:"URL pulsante...",className:"p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded text-[var(--foreground)] text-xs"})]})}function de({block:t,index:s,onUpdate:a}){switch(t.type){case"paragraph":return e.jsx(ae,{text:t.text,onChange:o=>a({text:o})});case"heading":return e.jsx(oe,{level:t.level,text:t.text,onChangeLevel:o=>a({level:o}),onChangeText:o=>a({text:o})});case"list":return e.jsx(se,{ordered:t.ordered,items:t.items,onChangeOrdered:o=>a({ordered:o}),onChangeItems:o=>a({items:o})});case"callout":return e.jsx(le,{variant:t.variant,title:t.title,text:t.text,onChangeVariant:o=>a({variant:o}),onChangeTitle:o=>a({title:o}),onChangeText:o=>a({text:o})});case"faq":return e.jsx(ne,{items:t.items,onChangeItems:o=>a({items:o})});case"cta":return e.jsx(ie,{title:t.title,description:t.description,buttonText:t.buttonText,buttonUrl:t.buttonUrl,onChange:(o,u)=>a({[o]:u})});default:return e.jsx("div",{className:"text-slate-400",children:"Blocco non supportato"})}}const ce=[{type:"paragraph",label:"+ Paragrafo"},{type:"heading",label:"+ Titolo"},{type:"list",label:"+ Lista"},{type:"callout",label:"+ Callout"},{type:"faq",label:"+ FAQ"},{type:"cta",label:"+ CTA"}];function ue({content:t,onAdd:s,onUpdate:a,onRemove:o,onMove:u}){return e.jsxs("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-bold text-lg text-[var(--foreground)]",children:"Contenuto"}),e.jsx("div",{className:"flex gap-2",children:ce.map(({type:g,label:d})=>e.jsx("button",{onClick:()=>s(g),className:"px-3 py-1 text-sm bg-slate-100 dark:bg-slate-800 hover:bg-slate-200 dark:hover:bg-slate-700 text-[var(--foreground)] opacity-70 hover:opacity-100 rounded transition-colors",children:d},g))})]}),t.length===0?e.jsx("div",{className:"text-center py-12 text-slate-400",children:"Clicca su un pulsante sopra per aggiungere contenuto"}):e.jsx("div",{className:"space-y-4",children:t.map((g,d)=>e.jsx(re,{index:d,type:g.type,isFirst:d===0,isLast:d===t.length-1,onMove:u,onRemove:o,children:e.jsx(de,{block:g,index:d,onUpdate:l=>a(d,l)})},d))})]})}const F={content:"ðŸ“ Contenuto",media:"ðŸ–¼ï¸ Media",seo:"ðŸ” SEO",publish:"ðŸ“¤ Pubblicazione"};function ge({activeSection:t,onChangeSection:s}){return e.jsx("div",{className:"w-48 shrink-0",children:e.jsx("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] overflow-hidden sticky top-24",children:Object.keys(F).map(a=>e.jsx("button",{onClick:()=>s(a),className:`w-full text-left px-4 py-3 border-b border-[var(--card-border)] last:border-b-0 transition-colors ${t===a?"bg-emerald-50 dark:bg-emerald-500/10 text-emerald-700 dark:text-emerald-400 font-medium":"text-[var(--foreground)] opacity-60 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:F[a]},a))})})}function ye(){const{formState:t,categories:s,allTags:a,isNew:o,loading:u,saving:g,uploading:d,updateField:l,handleTitleChange:p,handleSave:x,handleImageUpload:v,addBlock:I,updateBlock:w,removeBlock:A,moveBlock:C,navigate:k}=Y(),[y,E]=m.useState("content"),[B,T]=m.useState(!1),z=m.useMemo(()=>$(t.content),[t.content]),P=r=>{if(r.title&&p(r.title),r.subtitle&&l("subtitle",r.subtitle),r.slug&&l("slug",r.slug),r.category){const c=r.category.toLowerCase(),n=s.find(i=>i.name.toLowerCase()===c||i.slug===c);n&&l("categoryId",n.id)}if(r.tags&&Array.isArray(r.tags)){const c=r.tags.map(n=>{var i;return(i=a.find(b=>b.name.toLowerCase()===n.toLowerCase()))==null?void 0:i.id}).filter(n=>n!==void 0);l("selectedTags",c)}r.content&&Array.isArray(r.content)&&l("content",r.content),r.seo_title&&l("seoTitle",r.seo_title),r.seo_description&&l("seoDescription",r.seo_description),alert("Importazione completata! Verifica i dati e aggiungi l'immagine di copertina.")},O=async r=>{var n;const c=(n=r.target.files)==null?void 0:n[0];c&&await v(c),r.target.value=""};return u?e.jsx(M,{children:e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-slate-500",children:"Caricamento..."})})}):e.jsx(M,{children:e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex items-center justify-between sticky top-0 z-20 bg-[var(--background)]/95 backdrop-blur py-4 border-b border-[var(--card-border)] -mx-6 px-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>k("/admin/blog"),className:"text-[var(--foreground)] opacity-40 hover:opacity-100 transition-all font-medium",children:"â† Torna"}),e.jsx("h1",{className:"text-xl font-black text-[var(--foreground)] tracking-tight",children:o?"Nuovo Articolo":"Modifica Articolo"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${U[t.status].bgColor} ${U[t.status].color}`,children:U[t.status].label})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>T(!0),className:"px-4 py-2 bg-indigo-50 text-indigo-600 border border-indigo-100 rounded-lg hover:bg-indigo-100 font-medium transition-colors flex items-center gap-2",children:"ðŸ¤– Importa AI"}),e.jsx("button",{onClick:x,disabled:g,className:"bg-emerald-600 hover:bg-emerald-500 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold px-6 py-2 rounded-lg transition-colors shadow-lg shadow-emerald-500/20",children:g?"Salvataggio...":"Salva"})]})]}),e.jsxs("div",{className:"flex gap-6 items-start",children:[e.jsx(ge,{activeSection:y,onChangeSection:E}),e.jsxs("div",{className:"flex-1 space-y-6 min-w-0",children:[y==="content"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] p-6 space-y-4",children:[e.jsx("h2",{className:"font-bold text-lg text-[var(--foreground)]",children:"Titolo e Sottotitolo"}),e.jsx("input",{type:"text",placeholder:"Titolo dell'articolo",value:t.title,onChange:r=>p(r.target.value),className:"w-full px-4 py-3 text-xl font-bold bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-emerald-500 placeholder-[var(--foreground)]/30"}),e.jsx("input",{type:"text",placeholder:"Sottotitolo / Hook (opzionale)",value:t.subtitle,onChange:r=>l("subtitle",r.target.value),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] opacity-70 focus:outline-none focus:ring-2 focus:ring-emerald-500 placeholder-[var(--foreground)]/30"})]}),e.jsxs("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] p-6 space-y-4",children:[e.jsx("h2",{className:"font-bold text-lg text-[var(--foreground)]",children:"Organizzazione"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:"Categoria"}),e.jsxs("select",{value:t.categoryId,onChange:r=>l("categoryId",r.target.value),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] opacity-80 focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[e.jsx("option",{value:"",children:"Seleziona categoria..."}),s.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:"Tag"}),e.jsx("div",{className:"flex flex-wrap gap-2 p-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg min-h-[42px]",children:a.slice(0,10).map(r=>e.jsxs("label",{className:"flex items-center gap-1 text-sm text-[var(--foreground)] opacity-60 cursor-pointer hover:opacity-100",children:[e.jsx("input",{type:"checkbox",checked:t.selectedTags.includes(r.id),onChange:c=>{const n=c.target.checked?[...t.selectedTags,r.id]:t.selectedTags.filter(i=>i!==r.id);l("selectedTags",n)},className:"rounded border-slate-300 dark:border-slate-700 dark:bg-slate-800 text-emerald-500 focus:ring-emerald-500"}),r.name]},r.id))})]})]})]}),e.jsx("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] p-6",children:e.jsx(ue,{content:t.content,onAdd:I,onUpdate:w,onRemove:A,onMove:C})})]}),y==="media"&&e.jsxs("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] p-6 space-y-6",children:[e.jsx("h2",{className:"font-bold text-lg text-[var(--foreground)]",children:"Immagine di Copertina"}),e.jsxs("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-8 text-center hover:bg-slate-50 dark:hover:bg-slate-900/50 transition-colors relative group cursor-pointer bg-slate-50/50 dark:bg-slate-900/20",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:O,disabled:d,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer disabled:cursor-not-allowed z-10"}),e.jsxs("div",{className:"space-y-3 pointer-events-none",children:[e.jsx("div",{className:"text-4xl group-hover:scale-110 transition-transform duration-200",children:d?"â³":"ðŸ“¤"}),e.jsx("div",{className:"font-medium text-[var(--foreground)] opacity-60",children:d?"Caricamento in corso...":"Clicca o trascina un immagine qui"}),e.jsx("div",{className:"text-sm text-[var(--foreground)] opacity-40",children:"JPG, PNG, WebP (max 5MB)"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm text-[var(--foreground)] opacity-60 font-medium",children:"Oppure incolla URL"}),e.jsx("input",{type:"text",placeholder:"https://...",value:t.coverImageUrl,onChange:r=>l("coverImageUrl",r.target.value),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] text-sm focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),t.coverImageUrl&&e.jsxs("div",{className:"space-y-2 pt-4 border-t border-[var(--card-border)]",children:[e.jsx("div",{className:"text-sm font-medium text-[var(--foreground)] opacity-60",children:"Anteprima"}),e.jsxs("div",{className:"relative group max-w-lg",children:[e.jsx("img",{src:t.coverImageUrl,alt:"Preview",className:"rounded-lg border border-[var(--card-border)] w-full shadow-sm bg-slate-50 dark:bg-slate-900",onError:r=>r.currentTarget.src="https://placehold.co/600x400?text=Immagine+non+valida"}),e.jsx("button",{onClick:()=>l("coverImageUrl",""),className:"absolute top-2 right-2 bg-white dark:bg-slate-800 hover:bg-slate-100 dark:hover:bg-slate-700 text-rose-500 p-2 rounded-full shadow-md transition-colors",title:"Rimuovi immagine",children:"âœ•"})]})]})]}),y==="seo"&&e.jsxs("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] p-6 space-y-4",children:[e.jsx("h2",{className:"font-bold text-lg text-[var(--foreground)]",children:"SEO"}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:["Slug URL",e.jsxs("span",{className:"opacity-40 font-normal ml-2",children:["/blog/",t.slug||"url-articolo"]})]}),e.jsx("input",{type:"text",value:t.slug,onChange:r=>l("slug",r.target.value.toLowerCase().replace(/[^a-z0-9-]/g,"-")),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:["Titolo SEO",e.jsxs("span",{className:"opacity-40 font-normal ml-2",children:["(",(t.seoTitle||t.title).length,"/60)"]})]}),e.jsx("input",{type:"text",value:t.seoTitle,onChange:r=>l("seoTitle",r.target.value),placeholder:t.title||"Titolo per i motori di ricerca",className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:["Meta Description",e.jsxs("span",{className:"opacity-40 font-normal ml-2",children:["(",t.seoDescription.length,"/160)"]})]}),e.jsx("textarea",{value:t.seoDescription,onChange:r=>l("seoDescription",r.target.value),placeholder:"Descrizione che apparirÃ  nei risultati di ricerca...",className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-emerald-500 min-h-[80px]"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:"Canonical URL (opzionale)"}),e.jsx("input",{type:"text",value:t.canonicalUrl,onChange:r=>l("canonicalUrl",r.target.value),placeholder:"https://idoneo.it/blog/...",className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-4 bg-amber-50 dark:bg-amber-500/10 rounded-lg border border-amber-200 dark:border-amber-500/20",children:[e.jsx("input",{type:"checkbox",checked:t.isNoindex,onChange:r=>l("isNoindex",r.target.checked),className:"rounded border-slate-300 dark:border-slate-700 dark:bg-slate-800 text-amber-500 focus:ring-amber-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-amber-800 dark:text-amber-400",children:"Nascondi dai motori di ricerca (noindex)"}),e.jsx("div",{className:"text-sm text-amber-600 dark:text-amber-500",children:"Attiva solo per contenuti di test o bassa qualitÃ "})]})]})]}),y==="publish"&&e.jsxs("div",{className:"bg-[var(--card)] rounded-xl border border-[var(--card-border)] p-6 space-y-4",children:[e.jsx("h2",{className:"font-bold text-lg text-[var(--foreground)]",children:"Pubblicazione"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:"Stato"}),e.jsxs("select",{value:t.status,onChange:r=>l("status",r.target.value),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-emerald-500",children:[e.jsx("option",{value:"draft",children:"ðŸ“ Bozza"}),e.jsx("option",{value:"scheduled",children:"â° Programmato"}),e.jsx("option",{value:"published",children:"âœ… Pubblicato"}),e.jsx("option",{value:"archived",children:"ðŸ“¦ Archiviato"})]})]}),(t.status==="scheduled"||t.status==="published")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-[var(--foreground)] opacity-60 mb-2",children:"Data di pubblicazione"}),e.jsx("input",{type:"datetime-local",value:t.publishedAt,onChange:r=>l("publishedAt",r.target.value),className:"w-full px-4 py-2 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg text-[var(--foreground)] focus:outline-none focus:ring-2 focus:ring-emerald-500"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-4 bg-emerald-50 dark:bg-emerald-500/10 rounded-lg border border-emerald-200 dark:border-emerald-500/20",children:[e.jsx("input",{type:"checkbox",checked:t.isFeatured,onChange:r=>l("isFeatured",r.target.checked),className:"rounded border-slate-300 dark:border-slate-700 dark:bg-slate-800 text-emerald-500 focus:ring-emerald-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-emerald-800 dark:text-emerald-400",children:"â­ Articolo in evidenza"}),e.jsx("div",{className:"text-sm text-emerald-600 dark:text-emerald-500",children:"Mostra in primo piano nella pagina del blog"})]})]}),e.jsx("div",{className:"pt-4 border-t border-[var(--card-border)]",children:e.jsxs("div",{className:"text-sm text-[var(--foreground)] opacity-40",children:["Tempo di lettura stimato: ",e.jsxs("strong",{className:"opacity-100",children:[z," min"]})]})})]})]})]}),e.jsx(ee,{isOpen:B,onClose:()=>T(!1),onImport:P})]})})}export{ye as default};
