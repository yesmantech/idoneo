import{j as e}from"./framer-CcO5Kjcw.js";import{r as x}from"./router-ClfHAwMg.js";import{A as D}from"./AdminLayout-BOgckf8M.js";import{t as T,ag as O,b as N,O as k,aH as E,aI as G,Q as L,Z as V,w as Q,aJ as q,F as I,m as _,j as R,r as U,ad as B,_ as H,a2 as J,aA as C,aK as Y,aL as Z,x as K,X,T as W}from"./icons-Dvxa2Qho.js";import{s as h}from"./index-BcNl-kiB.js";import"./react-vendor-B--z-fyW.js";import"./supabase-CIvuJI4W.js";function ee({title:i,description:d,priority:l,trend:s,recommendation:o}){const t={low:"bg-emerald-50 text-emerald-700 border-emerald-100 dark:bg-emerald-950/30 dark:border-emerald-900/30",medium:"bg-amber-50 text-amber-700 border-amber-100 dark:bg-amber-950/30 dark:border-amber-900/30",high:"bg-rose-50 text-rose-700 border-rose-100 dark:bg-rose-950/30 dark:border-rose-900/30"},n=l==="high"?T:l==="medium"?O:N;return e.jsxs("div",{className:`p-5 rounded-[24px] border transition-all duration-300 ${t[l]} group hover:shadow-lg`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{className:"w-5 h-5 opacity-80"}),e.jsx("h3",{className:"font-bold text-[15px]",children:i})]}),s&&e.jsxs("div",{className:`flex items-center gap-1 text-[11px] font-bold uppercase tracking-wider px-2 py-0.5 rounded-full ${s==="up"?"bg-emerald-100/50 text-emerald-700":s==="down"?"bg-rose-100/50 text-rose-700":"bg-slate-100/50 text-slate-700"}`,children:[s==="up"?e.jsx(k,{className:"w-3 h-3"}):s==="down"?e.jsx(E,{className:"w-3 h-3"}):null,s]})]}),e.jsx("p",{className:"text-[13px] opacity-80 mb-4 leading-relaxed",children:d}),e.jsxs("div",{className:"bg-white/40 dark:bg-black/20 p-4 rounded-xl border border-white/20 dark:border-black/10",children:[e.jsxs("div",{className:"text-[11px] font-bold uppercase tracking-widest opacity-40 mb-1.5 flex items-center gap-1.5",children:[e.jsx(N,{className:"w-3 h-3"}),"AI Recommendation"]}),e.jsxs("p",{className:"text-[13px] font-medium italic",children:['"',o,'"']})]})]})}function te(i,d=1e3){const[l,s]=x.useState(0);return x.useEffect(()=>{if(i===0){s(0);return}let o,t;const n=c=>{o||(o=c);const u=Math.min((c-o)/d,1),r=1-Math.pow(1-u,4);s(Math.floor(r*i)),u<1&&(t=requestAnimationFrame(n))};return t=requestAnimationFrame(n),()=>cancelAnimationFrame(t)},[i,d]),l}function z({icon:i,label:d,value:l,suffix:s="",trend:o,trendValue:t,color:n}){const c=te(l);return e.jsxs("div",{className:"relative overflow-hidden bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-5 rounded-[20px] shadow-sm group hover:shadow-lg transition-all duration-300",children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-br ${n} opacity-0 group-hover:opacity-5 transition-opacity`}),e.jsx("div",{className:`w-10 h-10 rounded-xl bg-gradient-to-br ${n} flex items-center justify-center mb-3 shadow-lg`,children:e.jsx(i,{className:"w-5 h-5 text-white"})}),e.jsx("p",{className:"text-xs font-semibold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-1",children:d}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-2xl font-bold text-slate-900 dark:text-white tabular-nums",children:[c,s]}),o&&t&&e.jsxs("div",{className:`flex items-center gap-0.5 text-xs font-bold ${o==="up"?"text-emerald-500":o==="down"?"text-rose-500":"text-slate-400"}`,children:[o==="up"?e.jsx(k,{className:"w-3 h-3"}):o==="down"?e.jsx(E,{className:"w-3 h-3"}):null,t]})]}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]})})]})}function se(){const[i,d]=x.useState({newUsers:0,quizzesCompleted:0,avgScore:0,activeStreaks:0}),[l,s]=x.useState({newUsers:0,quizzesCompleted:0}),[o,t]=x.useState(!0);x.useEffect(()=>{n();const f=setInterval(n,3e4);return()=>clearInterval(f)},[]);async function n(){const f=new Date;f.setHours(0,0,0,0);const m=f.toISOString(),g=new Date(f);g.setDate(g.getDate()-1);const w=g.toISOString();try{const{count:j}=await h.from("profiles").select("*",{count:"exact",head:!0}).gte("created_at",m),{count:v}=await h.from("quiz_attempts").select("*",{count:"exact",head:!0}).gte("finished_at",m).not("finished_at","is",null),{data:a}=await h.from("quiz_attempts").select("score").gte("finished_at",m).not("finished_at","is",null).not("score","is",null),b=a&&a.length>0?Math.round(a.reduce((F,M)=>F+(M.score||0),0)/a.length):0,{count:y}=await h.from("profiles").select("*",{count:"exact",head:!0}).gte("streak_current",3),{count:A}=await h.from("profiles").select("*",{count:"exact",head:!0}).gte("created_at",w).lt("created_at",m),{count:P}=await h.from("quiz_attempts").select("*",{count:"exact",head:!0}).gte("finished_at",w).lt("finished_at",m).not("finished_at","is",null);d({newUsers:j||0,quizzesCompleted:v||0,avgScore:b,activeStreaks:y||0}),s({newUsers:A||0,quizzesCompleted:P||0})}catch(j){console.error("Failed to fetch today stats:",j)}finally{t(!1)}}const c=i.newUsers>l.newUsers?"up":i.newUsers<l.newUsers?"down":"neutral",u=l.newUsers>0?`${Math.round((i.newUsers-l.newUsers)/l.newUsers*100)}%`:"+∞",r=i.quizzesCompleted>l.quizzesCompleted?"up":i.quizzesCompleted<l.quizzesCompleted?"down":"neutral",p=l.quizzesCompleted>0?`${Math.round((i.quizzesCompleted-l.quizzesCompleted)/l.quizzesCompleted*100)}%`:"+∞";return e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-violet-500 to-purple-600 flex items-center justify-center",children:e.jsx(G,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-slate-900 dark:text-white",children:"Live Metrics"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Aggiornato ogni 30 secondi"})]})]}),e.jsxs("div",{className:"text-xs text-slate-400 flex items-center gap-2",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),"LIVE"]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(z,{icon:L,label:"Nuovi Utenti Oggi",value:i.newUsers,trend:c,trendValue:u,color:"from-blue-500 to-cyan-500"}),e.jsx(z,{icon:V,label:"Quiz Completati",value:i.quizzesCompleted,trend:r,trendValue:p,color:"from-amber-500 to-orange-500"}),e.jsx(z,{icon:Q,label:"Punteggio Medio",value:i.avgScore,suffix:"%",color:"from-emerald-500 to-green-500"}),e.jsx(z,{icon:k,label:"Streak Attive (3+)",value:i.activeStreaks,color:"from-rose-500 to-pink-500"})]})]})}function ae(){const[i,d]=x.useState([]),[l,s]=x.useState(!0),[o,t]=x.useState("streak");x.useEffect(()=>{n()},[o]);async function n(){s(!0);try{if(o==="streak"){const{data:r}=await h.from("profiles").select("id, nickname, avatar_url, streak_current, streak_best").order("streak_current",{ascending:!1}).limit(5);d((r||[]).map(p=>({...p,total_attempts:0,success_rate:0})))}else{const{data:r}=await h.from("quiz_attempts").select("user_id, is_idoneo, profiles(nickname, avatar_url, streak_current, streak_best)").not("finished_at","is",null).limit(500),p={};(r||[]).forEach(m=>{var w,j,v,a;const g=m.user_id;p[g]||(p[g]={id:g,nickname:((w=m.profiles)==null?void 0:w.nickname)||"Anonimo",avatar_url:((j=m.profiles)==null?void 0:j.avatar_url)||null,streak_current:((v=m.profiles)==null?void 0:v.streak_current)||0,streak_best:((a=m.profiles)==null?void 0:a.streak_best)||0,total_attempts:0,success_rate:0}),p[g].total_attempts++,m.is_idoneo&&p[g].success_rate++});const f=Object.values(p).map(m=>({...m,success_rate:m.total_attempts>0?Math.round(m.success_rate/m.total_attempts*100):0})).sort((m,g)=>g.total_attempts-m.total_attempts).slice(0,5);d(f)}}catch(r){console.error("Failed to fetch power users:",r)}finally{s(!1)}}const c=r=>r===0?"from-yellow-400 to-amber-500":r===1?"from-slate-300 to-slate-400":r===2?"from-amber-600 to-orange-700":"from-slate-500 to-slate-600",u=r=>r===0?e.jsx(q,{className:"w-3 h-3"}):r===1?e.jsx(_,{className:"w-3 h-3"}):r===2?e.jsx(_,{className:"w-3 h-3"}):e.jsx("span",{className:"text-[10px] font-bold",children:r+1});return e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-[24px] p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-amber-500 to-orange-600 flex items-center justify-center",children:e.jsx(q,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"Power Users"})]}),e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800 rounded-lg p-1",children:[e.jsxs("button",{onClick:()=>t("streak"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-all ${o==="streak"?"bg-white dark:bg-slate-700 text-slate-900 dark:text-white shadow-sm":"text-slate-500"}`,children:[e.jsx(I,{className:"w-3 h-3 inline mr-1"}),"Streak"]}),e.jsxs("button",{onClick:()=>t("volume"),className:`px-3 py-1 text-xs font-semibold rounded-md transition-all ${o==="volume"?"bg-white dark:bg-slate-700 text-slate-900 dark:text-white shadow-sm":"text-slate-500"}`,children:[e.jsx(_,{className:"w-3 h-3 inline mr-1"}),"Volume"]})]})]}),l?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(r=>e.jsx("div",{className:"h-12 bg-slate-100 dark:bg-slate-800 rounded-xl animate-pulse"},r))}):i.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(_,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),e.jsx("p",{className:"text-sm",children:"Nessun dato disponibile"})]}):e.jsx("div",{className:"space-y-2",children:i.map((r,p)=>{var f,m;return e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-xl hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors group cursor-pointer",children:[e.jsx("div",{className:`w-6 h-6 rounded-full bg-gradient-to-br ${c(p)} flex items-center justify-center text-white shadow-sm`,children:u(p)}),e.jsx("div",{className:"w-9 h-9 rounded-full bg-gradient-to-br from-slate-200 to-slate-300 dark:from-slate-700 dark:to-slate-600 flex items-center justify-center overflow-hidden",children:r.avatar_url?e.jsx("img",{src:r.avatar_url,alt:"",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-sm font-bold text-slate-500 dark:text-slate-400",children:((m=(f=r.nickname)==null?void 0:f[0])==null?void 0:m.toUpperCase())||"?"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-semibold text-sm text-slate-900 dark:text-white truncate",children:r.nickname||"Anonimo"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:o==="streak"?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-3 h-3 inline text-orange-500 mr-1"}),r.streak_current," giorni • Best: ",r.streak_best]}):e.jsxs(e.Fragment,{children:[r.total_attempts," quiz • ",r.success_rate,"% success"]})})]}),e.jsx(R,{className:"w-4 h-4 text-slate-300 dark:text-slate-600 opacity-0 group-hover:opacity-100 transition-opacity"})]},r.id)})})]})}function ie(){const[i,d]=x.useState(null),l=[{id:"import",icon:B,label:"Importa Domande",description:"Carica da CSV/Excel",color:"from-blue-500 to-cyan-500",onClick:()=>{window.location.href="/admin/import"}},{id:"export",icon:H,label:"Esporta Report",description:"Scarica analytics CSV",color:"from-emerald-500 to-green-500",onClick:()=>{alert("Export funzionalità in arrivo!")}},{id:"notify",icon:J,label:"Invia Notifica",description:"Push a tutti gli utenti",color:"from-amber-500 to-orange-500",onClick:()=>{alert("Notifiche push in arrivo!")}},{id:"refresh",icon:C,label:"Rigenera Cache",description:"Aggiorna leaderboard",color:"from-violet-500 to-purple-500",onClick:async()=>{d("refresh"),await new Promise(s=>setTimeout(s,1500)),d(null),alert("Cache rigenerata!")}},{id:"database",icon:Y,label:"Database Studio",description:"Apri Supabase",color:"from-slate-500 to-slate-600",onClick:()=>{window.open("https://supabase.com/dashboard","_blank")}},{id:"settings",icon:U,label:"Impostazioni",description:"Configura app",color:"from-rose-500 to-pink-500",onClick:()=>{window.location.href="/admin/settings"}}];return e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-[24px] p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center",children:e.jsx(U,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"Azioni Rapide"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.map(s=>e.jsxs("button",{onClick:s.onClick,disabled:i===s.id,className:`
                            relative p-4 rounded-xl text-left transition-all duration-200
                            bg-slate-50 dark:bg-slate-800/50 
                            hover:bg-slate-100 dark:hover:bg-slate-800 
                            hover:shadow-md hover:scale-[1.02] active:scale-[0.98]
                            disabled:opacity-50 disabled:cursor-wait
                            group
                        `,children:[e.jsx("div",{className:`w-9 h-9 rounded-xl bg-gradient-to-br ${s.color} flex items-center justify-center mb-2 shadow-sm group-hover:shadow-md transition-shadow`,children:i===s.id?e.jsx(C,{className:"w-4 h-4 text-white animate-spin"}):e.jsx(s.icon,{className:"w-4 h-4 text-white"})}),e.jsx("p",{className:"font-semibold text-sm text-slate-900 dark:text-white",children:s.label}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5",children:s.description}),e.jsx(R,{className:"absolute top-4 right-3 w-4 h-4 text-slate-300 dark:text-slate-600 opacity-0 group-hover:opacity-100 transition-opacity"})]},s.id))})]})}const $={async getGrowthStats(){const{count:i}=await h.from("profiles").select("*",{count:"exact",head:!0}),{data:d,count:l}=await h.from("quiz_attempts").select("id, finished_at, is_idoneo",{count:"exact"}),s=(d==null?void 0:d.filter(n=>n.finished_at))||[];s.filter(n=>n.is_idoneo).length;const o=l?s.length/l*100:0;return{totalUsers:i||0,totalAttempts:l||0,completionRate:o,weeklyGrowth:12}},async getQuizPerformance(i=5){const{data:d,error:l}=await h.from("quiz_attempts").select(`
                id,
                is_idoneo,
                quizzes (
                    title
                )
            `).not("quizzes","is",null).limit(500);if(l||!d)return[];const s={};return d.forEach(o=>{var n;const t=((n=o.quizzes)==null?void 0:n.title)||"Unknown";s[t]||(s[t]={total:0,success:0}),s[t].total++,o.is_idoneo&&s[t].success++}),Object.entries(s).map(([o,t])=>({quizTitle:o,attemptsCount:t.total,successRate:t.success/t.total*100})).sort((o,t)=>t.attemptsCount-o.attemptsCount).slice(0,i)}},S={async getActiveInsights(){const{data:i,error:d}=await h.from("admin_insights").select("*").eq("is_active",!0).order("priority",{ascending:!0}).order("created_at",{ascending:!1});if(d)return console.error("Failed to fetch insights:",d),[];const l={high:0,medium:1,low:2};return(i||[]).sort((s,o)=>l[s.priority]-l[o.priority])},async dismissInsight(i){const{error:d}=await h.from("admin_insights").update({is_active:!1}).eq("id",i);d&&console.error("Failed to dismiss insight:",d)},async generateInsights(){const i=[],{data:d}=await h.from("quiz_attempts").select(`
                id,
                finished_at,
                is_idoneo,
                quiz_id,
                quizzes (title)
            `).limit(1e3);if(d&&d.length>0){const t={};d.forEach(n=>{var r;const c=n.quiz_id,u=((r=n.quizzes)==null?void 0:r.title)||"Unknown";t[c]||(t[c]={title:u,total:0,completed:0,success:0}),t[c].total++,n.finished_at&&t[c].completed++,n.is_idoneo&&t[c].success++}),Object.entries(t).forEach(([n,c])=>{if(c.total>=10){const u=c.completed/c.total*100,r=c.completed>0?c.success/c.completed*100:0;u<50&&i.push({insight_type:"conversion",priority:u<30?"high":"medium",title:`Basso completamento: ${c.title}`,description:`Solo il ${Math.round(u)}% degli utenti completa questo quiz. ${c.total-c.completed} tentativi abbandonati.`,recommendation:"Considera di ridurre il numero di domande o aggiungere checkpoint intermedi.",trend:"down",metadata:{quiz_id:n,completion_rate:u},is_active:!0,expires_at:null}),r<40&&c.completed>=5&&i.push({insight_type:"alert",priority:r<25?"high":"medium",title:`Quiz troppo difficile: ${c.title}`,description:`Success rate del ${Math.round(r)}%. Gli utenti potrebbero scoraggiarsi.`,recommendation:"Verifica che le domande siano chiare e il tempo sufficiente.",trend:"down",metadata:{quiz_id:n,success_rate:r},is_active:!0,expires_at:null})}})}const{count:l}=await h.from("profiles").select("*",{count:"exact",head:!0}),{count:s}=await h.from("profiles").select("*",{count:"exact",head:!0}).gte("streak_current",3);if(l&&s){const t=s/l*100;t>20?i.push({insight_type:"trend",priority:"low",title:"Streak engagement alto",description:`${Math.round(t)}% degli utenti ha una streak di 3+ giorni.`,recommendation:"Considera di aggiungere badge o premi per le streak più lunghe.",trend:"up",metadata:{active_streaks:s,total_users:l},is_active:!0,expires_at:null}):t<5&&l>50&&i.push({insight_type:"alert",priority:"medium",title:"Streak engagement basso",description:`Solo ${Math.round(t)}% degli utenti mantiene una streak attiva.`,recommendation:"Aumenta la visibilità delle streak o invia notifiche push.",trend:"down",metadata:{active_streaks:s,total_users:l},is_active:!0,expires_at:null})}const{data:o}=await h.from("subjects").select("id, name, question_count:questions(count)").order("name");if(o&&o.forEach(t=>{var c,u;const n=((u=(c=t.question_count)==null?void 0:c[0])==null?void 0:u.count)||0;n<20&&n>0&&i.push({insight_type:"content_gap",priority:n<10?"high":"medium",title:`Poche domande: ${t.name}`,description:`Questa materia ha solo ${n} domande. Gli utenti potrebbero vedere ripetizioni.`,recommendation:`Aggiungi almeno ${50-n} domande per una copertura completa.`,trend:null,metadata:{subject_id:t.id,question_count:n},is_active:!0,expires_at:null})}),i.length>0){const{error:t}=await h.from("admin_insights").update({is_active:!1}).eq("is_active",!0);if(t)throw console.error("insightService: Failed to deactivate old insights:",t),new Error(`Errore Deactivate DB: ${t.message} (Probabile errore RLS)`);const{data:n,error:c}=await h.from("admin_insights").insert(i).select();if(c)throw console.error("insightService: Failed to save insights:",c),new Error(`Errore Salva DB: ${c.message} (Probabile errore RLS)`);return n||[]}return[]}};function ue(){const[i,d]=x.useState(null),[l,s]=x.useState([]),[o,t]=x.useState([]),[n,c]=x.useState(!0),[u,r]=x.useState(!1),[p,f]=x.useState(""),[m,g]=x.useState(!1);x.useEffect(()=>{async function a(){try{const[b,y,A]=await Promise.all([$.getGrowthStats(),$.getQuizPerformance(),S.getActiveInsights()]);d(b),s(y),t(A)}catch(b){console.error("Failed to load analytics:",b)}finally{c(!1)}}a()},[]);const w=async()=>{r(!0);try{console.log("AdminAnalyticsPage: Generating insights...");const a=await S.generateInsights();console.log("AdminAnalyticsPage: Insights generated:",a.length),t(a),a.length===0&&alert("Analisi completata, ma non sono stati rilevati nuovi insight significativi con i dati attuali.")}catch(a){console.error("Failed to generate insights:",a),alert(`Errore nella generazione degli insight: ${a.message||"Errore sconosciuto"}`)}finally{r(!1)}},j=async a=>{await S.dismissInsight(a),t(b=>b.filter(y=>y.id!==a))},v=async()=>{if(p.trim()){g(!0);try{console.log("AdminAnalyticsPage: Analyzing pasted data...");const a=await S.generateInsights();t(a),alert("Analisi completata con successo!")}catch(a){console.error("Failed to analyze:",a),alert(`Errore nell'analisi: ${a.message||"Errore sconosciuto"}`)}finally{g(!1)}}};return e.jsxs(D,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-violet-500 via-purple-600 to-indigo-600 flex items-center justify-center shadow-lg shadow-purple-500/20",children:e.jsx(Z,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:"Command Center"}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:"Il tuo quartier generale AI-powered"})]})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-2 px-4 py-2 bg-slate-100 dark:bg-slate-800 rounded-xl",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-emerald-500"})]}),e.jsx("span",{className:"text-xs font-semibold text-slate-600 dark:text-slate-400",children:"Sistema Operativo"})]})]}),e.jsx(se,{}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 p-6 rounded-[24px] shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-emerald-500 to-green-600 flex items-center justify-center",children:e.jsx(k,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"Performance per Quiz"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Tasso di successo delle principali simulazioni"})]})]})}),e.jsxs("div",{className:"space-y-5",children:[l.map((a,b)=>e.jsxs("div",{className:"group",children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"font-semibold text-slate-700 dark:text-slate-300 truncate max-w-[70%]",children:a.quizTitle}),e.jsxs("span",{className:"font-bold text-slate-900 dark:text-white",children:[Math.round(a.successRate),"%"]})]}),e.jsx("div",{className:"h-2.5 w-full bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-cyan-500 transition-all duration-1000 shadow-[0_0_8px_rgba(16,185,129,0.3)]",style:{width:`${a.successRate}%`}})}),e.jsxs("div",{className:"flex gap-3 mt-1.5 text-[10px] font-medium text-slate-400 uppercase tracking-wider",children:[e.jsxs("span",{children:[a.attemptsCount," tentativi"]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:a.successRate>=60?"text-emerald-500":a.successRate>=40?"text-amber-500":"text-rose-500",children:a.successRate>=60?"Ottimo":a.successRate>=40?"Nella Media":"Critico"})]})]},b)),l.length===0&&e.jsxs("div",{className:"text-center py-8 text-slate-400",children:[e.jsx(k,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),e.jsx("p",{className:"text-sm",children:"Nessun dato di performance disponibile"})]})]})]}),e.jsx(ie,{}),e.jsxs("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 border border-slate-200 dark:border-slate-700 p-6 rounded-[24px] relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-6 opacity-5",children:e.jsx(N,{className:"w-32 h-32 text-slate-500"})}),e.jsxs("div",{className:"flex items-center gap-3 mb-5 relative z-10",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center shadow-lg",children:e.jsx(K,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"AI Data Analyzer"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Incolla dati GA4 o metriche per analisi AI"})]})]}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("textarea",{className:"w-full h-28 bg-white dark:bg-slate-950 border border-slate-200 dark:border-slate-700 rounded-xl p-4 text-xs font-mono mb-3 focus:ring-2 focus:ring-cyan-500/20 focus:border-cyan-500/50 outline-none transition-all text-slate-800 dark:text-slate-200 placeholder-slate-400 resize-none",placeholder:"Incolla qui i dati JSON di GA4 o report tabulari...",value:p,onChange:a=>f(a.target.value)}),e.jsx("button",{onClick:v,disabled:!p||m,className:`w-full py-3 rounded-xl font-bold text-sm flex items-center justify-center gap-2 transition-all ${!p||m?"bg-slate-200 dark:bg-slate-700 text-slate-400 cursor-not-allowed":"bg-gradient-to-r from-cyan-500 to-blue-600 hover:from-cyan-400 hover:to-blue-500 text-white shadow-lg shadow-cyan-500/20"}`,children:m?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 animate-spin"}),"Analisi in corso..."]}):e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4"}),"Analizza con AI"]})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(ae,{}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 rounded-[24px] p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center",children:e.jsx(N,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:"AI Insights"})]}),e.jsxs("button",{onClick:w,disabled:u,className:"text-xs font-bold text-cyan-500 flex items-center gap-1 hover:text-cyan-400 transition-colors disabled:opacity-50",children:[e.jsx(C,{className:`w-3.5 h-3.5 ${u?"animate-spin":""}`}),"Rigenera"]})]}),o.length===0&&!u&&e.jsxs("div",{className:"text-center py-6 text-slate-400",children:[e.jsx(N,{className:"w-8 h-8 mx-auto mb-2 opacity-40"}),e.jsx("p",{className:"text-sm",children:"Nessun insight attivo."}),e.jsx("button",{onClick:w,className:"mt-2 text-sm font-bold text-cyan-500 hover:underline",children:"Genera insight"})]}),u&&e.jsxs("div",{className:"text-center py-6",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-cyan-500/30 border-t-cyan-500 rounded-full animate-spin mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-slate-400",children:"Analizzando..."})]}),e.jsx("div",{className:"space-y-3",children:o.slice(0,3).map(a=>e.jsxs("div",{className:"relative group",children:[e.jsx(ee,{title:a.title,description:a.description,priority:a.priority,trend:a.trend,recommendation:a.recommendation||void 0}),e.jsx("button",{onClick:()=>j(a.id),className:"absolute top-2 right-2 p-1 bg-slate-100 dark:bg-slate-700 rounded-full opacity-0 group-hover:opacity-100 transition-opacity hover:bg-slate-200 dark:hover:bg-slate-600",title:"Nascondi",children:e.jsx(X,{className:"w-3 h-3 text-slate-500"})})]},a.id))}),e.jsx("div",{className:"mt-4 p-4 bg-cyan-500/5 border border-cyan-500/10 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(W,{className:"w-4 h-4 text-cyan-500 mt-0.5 flex-shrink-0"}),e.jsx("div",{children:e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed",children:"Gli insight sono generati automaticamente dai dati del database."})})]})})]})]})]})]})}export{ue as default};
